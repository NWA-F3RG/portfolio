<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Backup Infrastructure Migration - Proxmox Backup Server implementation achieving 100% backup success rate and 85% storage reduction through deduplication.">
    
    <!-- Security Headers -->
    <meta http-equiv="Content-Security-Policy" content="default-src 'self'; style-src 'self' 'unsafe-inline' https://fonts.googleapis.com; font-src 'self' https://fonts.gstatic.com; img-src 'self' data:; script-src 'self' 'unsafe-inline';">
    <meta http-equiv="X-Content-Type-Options" content="nosniff">
    <meta http-equiv="X-Frame-Options" content="DENY">
    <meta http-equiv="Referrer-Policy" content="strict-origin-when-cross-origin">
    
    <title>Backup Infrastructure Migration - Nate's Portfolio</title>
    
    <!-- Favicon -->
    <link rel="icon" type="image/svg+xml" href="/favicon.svg">
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
    <link rel="manifest" href="/site.webmanifest">
    
    <!-- Canonical URL -->
    <link rel="canonical" href="https://seggsy.co/pbs-storage">
    
    <!-- Open Graph / Social Media -->
    <meta property="og:title" content="Backup Infrastructure Migration - Nate's Portfolio">
    <meta property="og:description" content="Proxmox Backup Server implementation achieving 100% backup success rate and 85% storage reduction through deduplication.">
    <meta property="og:image" content="https://seggsy.co/og-image.png">
    <meta property="og:url" content="https://seggsy.co/pbs-storage">
    <meta property="og:type" content="article">
    
    <!-- Twitter Card -->
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="Backup Infrastructure Migration - Nate's Portfolio">
    <meta name="twitter:description" content="Proxmox Backup Server implementation achieving 100% backup success rate and 85% storage reduction.">
    <meta name="twitter:image" content="https://seggsy.co/og-image.png">
    
    <!-- Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;500;600&family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    
    <style>
        /* ==================== CSS Variables ==================== */
        :root {
            /* Background Colors - matches your existing pages */
            --color-bg-primary: #1e1e1e;
            --color-bg-secondary: #252526;
            --color-bg-tertiary: #2d2d30;
            --color-bg-code: #1e1e1e;
            
            /* Text Colors */
            --color-text-primary: #d4d4d4;
            --color-text-secondary: #909090;
            --color-text-muted: #6a6a6a;
            
            /* Accent Colors - matches your existing pages */
            --color-accent-primary: #ff6b35;
            --color-accent-secondary: #4ec9b0;
            --color-accent-warning: #ce9178;
            --color-accent-danger: #f87171;
            --color-accent-success: #4ec9b0;
            
            /* Border Colors */
            --color-border: #3e3e42;
            --color-border-hover: #5a5a5f;
            
            /* Syntax Highlighting */
            --color-syntax-keyword: #569cd6;
            --color-syntax-string: #ce9178;
            --color-syntax-function: #dcdcaa;
            --color-syntax-comment: #6a9955;
            
            /* Typography */
            --font-mono: 'JetBrains Mono', monospace;
            --font-sans: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
            
            /* Spacing */
            --space-xs: 0.25rem;
            --space-sm: 0.5rem;
            --space-md: 1rem;
            --space-lg: 1.5rem;
            --space-xl: 2rem;
            --space-2xl: 3rem;
            
            /* Border Radius */
            --radius-sm: 4px;
            --radius-md: 8px;
            --radius-lg: 12px;
        }
        
        /* ==================== Reset & Base ==================== */
        *, *::before, *::after {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }
        
        html {
            scroll-behavior: smooth;
        }
        
        /* Respect user's motion preferences */
        @media (prefers-reduced-motion: reduce) {
            html {
                scroll-behavior: auto;
            }
            *,
            *::before,
            *::after {
                animation-duration: 0.01ms !important;
                animation-iteration-count: 1 !important;
                transition-duration: 0.01ms !important;
                scroll-behavior: auto !important;
            }
        }
        
        body {
            font-family: var(--font-sans);
            background: var(--color-bg-primary);
            color: var(--color-text-primary);
            line-height: 1.6;
            font-size: 16px;
        }
        
        /* ==================== Skip Link (Accessibility) ==================== */
        .skip-link {
            position: absolute;
            top: -40px;
            left: 0;
            background: var(--color-accent-primary);
            color: var(--color-bg-primary);
            padding: var(--space-sm);
            text-decoration: none;
            border-radius: var(--radius-sm);
            font-weight: 600;
            z-index: 100;
        }
        
        .skip-link:focus {
            top: var(--space-sm);
            left: var(--space-sm);
        }
        
        /* ==================== Focus States (Accessibility) ==================== */
        *:focus-visible {
            outline: 2px solid var(--color-accent-primary);
            outline-offset: 2px;
        }
        
        *:focus:not(:focus-visible) {
            outline: none;
        }
        
        /* ==================== Header ==================== */
        header {
            background: var(--color-bg-secondary);
            border-bottom: 1px solid var(--color-border);
            padding: var(--space-md) 0;
            position: sticky;
            top: 0;
            z-index: 50;
        }
        
        nav {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 var(--space-md);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .logo {
            font-family: var(--font-mono);
            font-size: 1.25rem;
            font-weight: 600;
            color: var(--color-accent-primary);
            text-decoration: none;
        }
        
        .logo::before {
            content: '$ ';
            color: var(--color-accent-secondary);
        }
        
        .back-link {
            color: var(--color-text-secondary);
            text-decoration: none;
            font-size: 0.95rem;
            font-weight: 500;
            transition: color 0.2s;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }
        
        .back-link:hover {
            color: var(--color-accent-primary);
        }
        
        .back-link::before {
            content: '←';
            font-size: 1.2rem;
        }
        
        /* ==================== Main Content ==================== */
        main {
            max-width: 900px;
            margin: 0 auto;
            padding: var(--space-xl) var(--space-md);
        }
        
        /* ==================== Project Header ==================== */
        .project-header {
            margin-bottom: var(--space-xl);
            padding-bottom: var(--space-xl);
            border-bottom: 1px solid var(--color-border);
        }
        
        .project-tag {
            display: inline-block;
            font-family: var(--font-mono);
            font-size: 0.85rem;
            color: var(--color-accent-secondary);
            background: rgba(78, 201, 176, 0.1);
            padding: 0.25rem 0.75rem;
            border-radius: var(--radius-sm);
            margin-bottom: var(--space-md);
        }
        
        h1 {
            font-size: 2.5rem;
            font-weight: 700;
            color: var(--color-text-primary);
            margin-bottom: var(--space-md);
            line-height: 1.2;
        }
        
        .project-meta {
            display: flex;
            gap: var(--space-lg);
            font-size: 0.9rem;
            color: var(--color-text-secondary);
            margin-bottom: var(--space-md);
            flex-wrap: wrap;
        }
        
        .meta-item {
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }
        
        .meta-item strong {
            color: var(--color-text-primary);
        }
        
        .tldr {
            background: var(--color-bg-secondary);
            border-left: 4px solid var(--color-accent-primary);
            padding: var(--space-md);
            border-radius: var(--radius-md);
            margin-bottom: var(--space-xl);
        }
        
        .tldr-title {
            font-weight: 600;
            color: var(--color-accent-primary);
            margin-bottom: var(--space-sm);
            font-size: 1.1rem;
        }
        
        .key-achievement {
            background: var(--color-bg-tertiary);
            padding: var(--space-md);
            border-radius: var(--radius-sm);
            margin-top: var(--space-sm);
        }
        
        .key-achievement strong {
            color: var(--color-accent-primary);
        }
        
        /* ==================== Content Sections ==================== */
        .section {
            margin-bottom: var(--space-2xl);
        }
        
        h2 {
            font-size: 1.75rem;
            font-weight: 600;
            color: var(--color-text-primary);
            margin-bottom: var(--space-md);
            padding-bottom: var(--space-sm);
            border-bottom: 2px solid var(--color-border);
        }
        
        h3 {
            font-size: 1.35rem;
            font-weight: 600;
            color: var(--color-text-primary);
            margin-top: var(--space-lg);
            margin-bottom: var(--space-md);
        }
        
        h4 {
            font-size: 1.1rem;
            font-weight: 600;
            color: var(--color-accent-secondary);
            margin-top: var(--space-md);
            margin-bottom: var(--space-sm);
        }
        
        p {
            margin-bottom: var(--space-md);
            color: var(--color-text-primary);
        }
        
        ul, ol {
            margin-left: var(--space-lg);
            margin-bottom: var(--space-md);
        }
        
        li {
            margin-bottom: var(--space-sm);
            color: var(--color-text-primary);
        }
        
        /* ==================== Code Blocks ==================== */
        pre {
            background: var(--color-bg-code);
            border: 1px solid var(--color-border);
            border-radius: var(--radius-md);
            padding: var(--space-md);
            margin-bottom: var(--space-md);
            overflow-x: auto;
            font-family: var(--font-mono);
            font-size: 0.9rem;
            line-height: 1.5;
        }
        
        code {
            font-family: var(--font-mono);
            font-size: 0.9em;
            color: var(--color-accent-warning);
        }
        
        pre code {
            color: var(--color-text-primary);
        }
        
        .terminal {
            position: relative;
            background: #0c0c0c;
            border: 1px solid var(--color-border);
            border-radius: var(--radius-md);
            margin-bottom: var(--space-md);
        }
        
        .terminal::before {
            content: '';
            display: block;
            height: 30px;
            background: var(--color-bg-secondary);
            border-bottom: 1px solid var(--color-border);
            border-radius: var(--radius-md) var(--radius-md) 0 0;
        }
        
        .terminal pre {
            border: none;
            border-radius: 0 0 var(--radius-md) var(--radius-md);
            background: #0c0c0c;
            color: #00ff00;
        }
        
        /* ==================== Architecture Diagram ==================== */
        .architecture {
            background: var(--color-bg-secondary);
            border: 1px solid var(--color-border);
            border-radius: var(--radius-md);
            padding: var(--space-md);
            margin-bottom: var(--space-md);
        }
        
        .architecture pre {
            background: transparent;
            border: none;
            color: var(--color-accent-secondary);
            font-size: 0.85rem;
        }
        
        /* ==================== Comparison Tables ==================== */
        .comparison {
            background: var(--color-bg-secondary);
            border: 1px solid var(--color-border);
            border-radius: var(--radius-md);
            padding: var(--space-md);
            margin-bottom: var(--space-md);
        }
        
        .comparison h4 {
            margin-top: 0;
            margin-bottom: var(--space-md);
        }
        
        .comparison-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: var(--space-md);
        }
        
        @media (max-width: 600px) {
            .comparison-grid {
                grid-template-columns: 1fr;
            }
        }
        
        .comparison-item {
            background: var(--color-bg-tertiary);
            padding: var(--space-md);
            border-radius: var(--radius-sm);
        }
        
        .comparison-label {
            font-weight: 600;
            color: var(--color-accent-primary);
            margin-bottom: var(--space-sm);
        }
        
        /* ==================== Collapsible Sections ==================== */
        .collapsible {
            background: var(--color-bg-secondary);
            border: 1px solid var(--color-border);
            border-radius: var(--radius-md);
            margin-bottom: var(--space-md);
            overflow: hidden;
        }
        
        .collapsible-header {
            padding: var(--space-md);
            cursor: pointer;
            display: flex;
            justify-content: space-between;
            align-items: center;
            user-select: none;
            transition: background 0.2s;
        }
        
        .collapsible-header:hover {
            background: var(--color-bg-tertiary);
        }
        
        .collapsible-title {
            font-weight: 600;
            color: var(--color-accent-primary);
            font-size: 1.1rem;
        }
        
        .collapsible-icon {
            font-size: 1.2rem;
            color: var(--color-text-secondary);
            transition: transform 0.3s;
        }
        
        .collapsible.active .collapsible-icon {
            transform: rotate(180deg);
        }
        
        .collapsible-content {
            max-height: 0;
            overflow: hidden;
            transition: max-height 0.3s ease-out;
        }
        
        .collapsible.active .collapsible-content {
            max-height: 5000px;
            transition: max-height 0.5s ease-in;
        }
        
        .collapsible-inner {
            padding: 0 var(--space-md) var(--space-md) var(--space-md);
        }
        
        /* ==================== Info Boxes ==================== */
        .info-box {
            background: rgba(78, 201, 176, 0.1);
            border: 1px solid var(--color-accent-secondary);
            border-radius: var(--radius-md);
            padding: var(--space-md);
            margin-bottom: var(--space-md);
        }
        
        .info-box strong {
            color: var(--color-accent-secondary);
        }
        
        .success-box {
            background: rgba(78, 201, 176, 0.1);
            border: 1px solid var(--color-accent-success);
            border-radius: var(--radius-md);
            padding: var(--space-md);
            margin-bottom: var(--space-md);
        }
        
        .success-box strong {
            color: var(--color-accent-success);
        }
        
        .warning-box {
            background: rgba(206, 145, 120, 0.1);
            border: 1px solid var(--color-accent-warning);
            border-radius: var(--radius-md);
            padding: var(--space-md);
            margin-bottom: var(--space-md);
        }
        
        .warning-box strong {
            color: var(--color-accent-warning);
        }
        
        /* ==================== Stats Grid ==================== */
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: var(--space-md);
            margin-bottom: var(--space-lg);
        }
        
        .stat-card {
            background: var(--color-bg-secondary);
            border: 1px solid var(--color-border);
            border-radius: var(--radius-md);
            padding: var(--space-md);
            text-align: center;
        }
        
        .stat-value {
            font-size: 2rem;
            font-weight: 700;
            color: var(--color-accent-primary);
            font-family: var(--font-mono);
            margin-bottom: var(--space-xs);
        }
        
        .stat-label {
            font-size: 0.9rem;
            color: var(--color-text-secondary);
        }
        
        /* ==================== STAR Format ==================== */
        .star-format {
            background: var(--color-bg-secondary);
            border: 1px solid var(--color-border);
            border-radius: var(--radius-md);
            padding: var(--space-lg);
        }
        
        .star-item {
            margin-bottom: var(--space-lg);
        }
        
        .star-item:last-child {
            margin-bottom: 0;
        }
        
        .star-label {
            display: inline-block;
            font-family: var(--font-mono);
            font-size: 0.85rem;
            font-weight: 600;
            color: var(--color-bg-primary);
            background: var(--color-accent-primary);
            padding: 0.25rem 0.75rem;
            border-radius: var(--radius-sm);
            margin-bottom: var(--space-sm);
        }
        
        .star-item p {
            margin-bottom: 0;
            font-style: italic;
            color: var(--color-text-secondary);
        }
        
        .star-item ul {
            margin-top: var(--space-sm);
            color: var(--color-text-secondary);
            font-style: italic;
        }
        
        /* ==================== Skills Grid ==================== */
        .skills-grid {
            display: flex;
            flex-wrap: wrap;
            gap: var(--space-sm);
            margin-top: var(--space-md);
        }
        
        .skill-badge {
            font-family: var(--font-mono);
            font-size: 0.85rem;
            background: var(--color-bg-tertiary);
            color: var(--color-accent-secondary);
            padding: 0.25rem 0.75rem;
            border-radius: var(--radius-sm);
            border: 1px solid var(--color-border);
        }
        
        /* ==================== Footer ==================== */
        footer {
            background: var(--color-bg-secondary);
            border-top: 1px solid var(--color-border);
            padding: var(--space-xl) var(--space-md);
            margin-top: var(--space-2xl);
        }
        
        .footer-content {
            max-width: 900px;
            margin: 0 auto;
            text-align: center;
        }
        
        .footer-nav {
            display: flex;
            justify-content: center;
            gap: var(--space-lg);
            margin-bottom: var(--space-md);
            flex-wrap: wrap;
        }
        
        .footer-nav a {
            color: var(--color-text-secondary);
            text-decoration: none;
            font-size: 0.9rem;
            transition: color 0.2s;
        }
        
        .footer-nav a:hover {
            color: var(--color-accent-primary);
        }
        
        .footer-copyright {
            color: var(--color-text-secondary);
            font-size: 0.85rem;
        }
        
        /* ==================== Responsive ==================== */
        @media (max-width: 768px) {
            h1 {
                font-size: 2rem;
            }
            
            h2 {
                font-size: 1.5rem;
            }
            
            h3 {
                font-size: 1.2rem;
            }
            
            .project-meta {
                flex-direction: column;
                gap: var(--space-sm);
            }
            
            .stats-grid {
                grid-template-columns: repeat(2, 1fr);
            }
            
            pre {
                font-size: 0.8rem;
            }
            
            .footer-nav {
                flex-direction: column;
                gap: var(--space-sm);
            }
        }
    </style>
</head>
<body>
    <a href="#main-content" class="skip-link">Skip to main content</a>
    
    <header>
        <nav aria-label="Main navigation">
            <a href="/" class="logo">nate</a>
            <a href="/" class="back-link">Back to Projects</a>
        </nav>
    </header>
    
    <main id="main-content" role="main">
        <!-- Project Header -->
        <div class="project-header">
            <span class="project-tag">Storage & Backup Infrastructure</span>
            <h1>Backup Infrastructure Migration</h1>
            
            <div class="project-meta">
                <span class="meta-item"><strong>Duration:</strong> ~8 hours</span>
                <span class="meta-item"><strong>Date:</strong> February 2026</span>
                <span class="meta-item"><strong>Status:</strong> Production</span>
            </div>
            
            <div class="tldr">
                <div class="tldr-title">TL;DR</div>
                <p>Migrated from unreliable USB-based backups to Proxmox Backup Server with internal SATA drives. Achieved 100% backup success rate (up from ~60%), reduced storage requirements by 85% through deduplication, and implemented node-level redundancy for hardware failure protection.</p>
                
                <div class="key-achievement">
                    <strong>Key Achievement:</strong> 100% backup success rate with 85% storage reduction and automatic node-to-node replication.
                </div>
            </div>
        </div>
        
        <!-- The Problem -->
        <section class="section">
            <h2>The Problem</h2>
            
            <h3>What I Started With</h3>
            <ul>
                <li>3-node Proxmox cluster with ~420GB of VM data</li>
                <li>Backups stored on 4.5TB external USB drive shared via NFS</li>
                <li>Backup jobs failing ~40% of nights due to USB disconnects</li>
                <li>VMs would sometimes shut down unexpectedly when mount path disappeared mid-backup</li>
                <li>No redundancy - single point of failure for all backups</li>
            </ul>
            
            <h3>Why USB Storage Failed</h3>
            <ul>
                <li><strong>Power management:</strong> USB drives go to sleep, causing mount path instability</li>
                <li><strong>Controller reliability:</strong> USB adds failure points between drive and system</li>
                <li><strong>No enterprise features:</strong> No RAID, no hot-swap, no monitoring</li>
                <li><strong>Mount lifecycle issues:</strong> Stale NFS mounts when drive reconnects</li>
            </ul>
            
            <div class="info-box">
                <strong>Real-World Impact:</strong> A failed backup means no recovery option if something goes wrong. With 40% failure rate, I was essentially gambling every night that nothing would break.
            </div>
        </section>
        
        <!-- The Solution -->
        <section class="section">
            <h2>The Solution</h2>
            
            <h3>Architecture Overview</h3>
            <p>Migrated to Proxmox Backup Server (PBS) with a distributed architecture across two nodes:</p>
            
            <div class="architecture">
                <pre>
                    PBS BACKUP ARCHITECTURE
    
    ┌─────────────────────────────────────────────────────────────┐
    │                    PROXMOX CLUSTER                          │
    │                                                             │
    │   ┌─────────┐      ┌─────────┐      ┌─────────┐            │
    │   │  pve01  │      │  pve02  │      │  pve03  │            │
    │   │  VMs    │      │  VMs    │      │  VMs    │            │
    │   └────┬────┘      └────┬────┘      └────┬────┘            │
    │        │                │                │                  │
    │        └────────────────┼────────────────┘                  │
    │                         │                                   │
    │                         ▼                                   │
    │              ┌─────────────────────┐                        │
    │              │   PBS Primary       │                        │
    │              │   (pve01 - 1TB)     │                        │
    │              │   Deduplication     │                        │
    │              └──────────┬──────────┘                        │
    │                         │                                   │
    │                    Auto Sync                                │
    │                    (2hr offset)                             │
    │                         │                                   │
    │                         ▼                                   │
    │              ┌─────────────────────┐                        │
    │              │   PBS Secondary     │                        │
    │              │   (pve02 - 731GB)   │                        │
    │              │   Redundant Copy    │                        │
    │              └─────────────────────┘                        │
    └─────────────────────────────────────────────────────────────┘
                </pre>
            </div>
            
            <h3>Key Components</h3>
            
            <h4>Internal SATA Storage</h4>
            <ul>
                <li>Eliminated USB entirely - direct SATA connection</li>
                <li>1TB drive on pve01 dedicated to PBS primary</li>
                <li>1TB drive on pve02 partitioned: 200GB NFS (ISOs/templates) + 731GB PBS sync target</li>
            </ul>
            
            <h4>Proxmox Backup Server</h4>
            <ul>
                <li>Chunk-level deduplication (85% storage savings)</li>
                <li>Automatic verification of backup integrity</li>
                <li>Let's Encrypt certificates via ACME for secure web UI</li>
                <li>Native integration with Proxmox VE</li>
            </ul>
            
            <h4>Automatic Replication</h4>
            <ul>
                <li>Primary syncs to secondary every night (2-hour offset from backups)</li>
                <li>If primary drive fails, secondary has complete copy</li>
                <li>Follows 3-2-1 backup principle (working toward offsite)</li>
            </ul>
        </section>
        
        <!-- Deduplication -->
        <section class="section">
            <h2>Deduplication Mechanics</h2>
            
            <div class="comparison">
                <h4>Storage Comparison</h4>
                <div class="comparison-grid">
                    <div class="comparison-item">
                        <div class="comparison-label">Without Deduplication (Traditional)</div>
                        <pre>Day 1: 100GB VM -> 100GB backup
Day 2: 100GB (2GB changed) -> 100GB
Day 3: 100GB (3GB changed) -> 100GB
Total: 300GB for 3 days</pre>
                    </div>
                    <div class="comparison-item">
                        <div class="comparison-label">With PBS Deduplication</div>
                        <pre>Day 1: 100GB VM -> 100GB chunks
Day 2: 100GB (2GB changed) -> +2GB
Day 3: 100GB (3GB changed) -> +3GB
Total: 105GB for 3 days
Savings: 65%</pre>
                    </div>
                </div>
            </div>
            
            <div class="success-box">
                <strong>Real-World Results:</strong>
                <ul style="margin-bottom: 0;">
                    <li>420GB of live VM data</li>
                    <li>1TB backup drive capacity</li>
                    <li><strong>Before PBS:</strong> Could store 1-2 full backup rotations</li>
                    <li><strong>After PBS:</strong> Storing 4+ weeks of daily backups with room to grow</li>
                </ul>
            </div>
        </section>
        
        <!-- The Challenges -->
        <section class="section">
            <h2>The Challenges</h2>
            
            <div class="collapsible">
                <div class="collapsible-header">
                    <div class="collapsible-title">Challenge 1: USB Disconnect During Migration</div>
                    <div class="collapsible-icon">▼</div>
                </div>
                <div class="collapsible-content">
                    <div class="collapsible-inner">
                        <h4>Symptom:</h4>
                        <div class="terminal">
                            <pre>rsync: failed to stat '/mnt/pve/exthdd/iso/ubuntu.iso': No such file or directory
External HDD mount point disappeared mid-migration</pre>
                        </div>
                        
                        <h4>Root Cause:</h4>
                        <ul>
                            <li>USB drive power management put drive to sleep during large file copy</li>
                            <li>Mount path became stale</li>
                            <li>rsync encountered non-existent path</li>
                        </ul>
                        
                        <h4>Solution:</h4>
                        <ol>
                            <li>Disabled USB autosuspend temporarily:
                                <pre><code>echo -1 > /sys/module/usbcore/parameters/autosuspend</code></pre>
                            </li>
                            <li>Used <code>rsync</code> with resume capability:
                                <pre><code>rsync -av --partial --progress /source/ /dest/</code></pre>
                            </li>
                            <li>Monitored transfer with <code>watch -n 1 df -h</code> to detect disconnects immediately</li>
                        </ol>
                        
                        <h4>Lesson Learned:</h4>
                        <p>USB reliability issues aren't always obvious. Understanding Linux power management, mount lifecycle, and resilient copy strategies is essential for safe data migrations.</p>
                    </div>
                </div>
            </div>
            
            <div class="collapsible">
                <div class="collapsible-header">
                    <div class="collapsible-title">Challenge 2: PBS ACME Certificate Configuration</div>
                    <div class="collapsible-icon">▼</div>
                </div>
                <div class="collapsible-content">
                    <div class="collapsible-inner">
                        <h4>Symptom:</h4>
                        <div class="terminal">
                            <pre>ACME challenge failed: DNS TXT record not found</pre>
                        </div>
                        
                        <h4>Root Cause:</h4>
                        <ul>
                            <li>PBS uses different ACME plugin format than PVE</li>
                            <li>Cloudflare API token needed specific permissions</li>
                            <li>DNS propagation delay caused initial failures</li>
                        </ul>
                        
                        <h4>Solution:</h4>
                        <ol>
                            <li>Created Cloudflare API token with Zone:DNS:Edit permissions</li>
                            <li>Configured PBS ACME plugin with correct credentials</li>
                            <li>Added delay to allow DNS propagation before verification</li>
                        </ol>
                        
                        <h4>Lesson Learned:</h4>
                        <p>Certificate automation requires understanding both the ACME protocol and your DNS provider's API. Different Proxmox products have slightly different configurations.</p>
                    </div>
                </div>
            </div>
            
            <div class="collapsible">
                <div class="collapsible-header">
                    <div class="collapsible-title">Challenge 3: Filesystem Tuning for Backup Workloads</div>
                    <div class="collapsible-icon">▼</div>
                </div>
                <div class="collapsible-content">
                    <div class="collapsible-inner">
                        <h4>Symptom:</h4>
                        <div class="terminal">
                            <pre>df shows less usable space than expected on 1TB drive</pre>
                        </div>
                        
                        <h4>Root Cause:</h4>
                        <ul>
                            <li>ext4 reserves 5% for root by default (~50GB on 1TB)</li>
                            <li>Default inode ratio wastes space for large-file workloads</li>
                        </ul>
                        
                        <h4>Solution:</h4>
                        <pre><code># Reduce reserved blocks from 5% to 1%
tune2fs -m 1 /dev/sda1

# Verify alignment for optimal performance
blockdev --getalignoff /dev/sda1</code></pre>
                        
                        <h4>Lesson Learned:</h4>
                        <p>Understanding tunable parameters (reserved blocks, inode ratio, alignment) maximizes usable capacity for specific workloads.</p>
                    </div>
                </div>
            </div>
        </section>
        
        <!-- Results -->
        <section class="section">
            <h2>Results</h2>
            
            <div class="stats-grid">
                <div class="stat-card">
                    <div class="stat-value">100%</div>
                    <div class="stat-label">Backup Success Rate</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value">85%</div>
                    <div class="stat-label">Storage Reduction</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value">30+</div>
                    <div class="stat-label">Days Retention</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value">0</div>
                    <div class="stat-label">Manual Interventions</div>
                </div>
            </div>
            
            <div class="success-box">
                <ul style="margin-bottom: 0;">
                    <li><strong>100% backup success rate</strong> (from 60%)</li>
                    <li><strong>85% storage reduction</strong> through chunk-level deduplication</li>
                    <li><strong>Node-level redundancy</strong> - automatic sync to secondary</li>
                    <li><strong>Extended retention</strong> - 30 daily + 8 weekly + 12 monthly backups</li>
                    <li><strong>Zero manual interventions</strong> since deployment</li>
                    <li><strong>Follows 3-2-1 principles</strong> (working toward offsite copy)</li>
                </ul>
            </div>
        </section>
        
        <!-- Lessons Learned -->
        <section class="section">
            <h2>Lessons Learned</h2>
            
            <div class="collapsible">
                <div class="collapsible-header">
                    <div class="collapsible-title">Lesson 1: USB Storage Is Not Enterprise-Grade</div>
                    <div class="collapsible-icon">▼</div>
                </div>
                <div class="collapsible-content">
                    <div class="collapsible-inner">
                        <p><strong>Observation:</strong> External USB drives are convenient for workstations but unsuitable for production backups.</p>
                        
                        <p><strong>Why:</strong></p>
                        <ul>
                            <li>USB power management can't be fully disabled</li>
                            <li>USB controllers add failure points</li>
                            <li>Sleep mode causes mount path instability</li>
                            <li>No inherent redundancy</li>
                        </ul>
                        
                        <p><strong>Better Approach:</strong> Internal storage with proper enterprise features (RAID, hot-swap, monitoring).</p>
                    </div>
                </div>
            </div>
            
            <div class="collapsible">
                <div class="collapsible-header">
                    <div class="collapsible-title">Lesson 2: Deduplication Transforms Storage Economics</div>
                    <div class="collapsible-icon">▼</div>
                </div>
                <div class="collapsible-content">
                    <div class="collapsible-inner">
                        <p><strong>Observation:</strong> PBS deduplication reduced storage requirements by 85%.</p>
                        
                        <p><strong>Math:</strong></p>
                        <ul>
                            <li>420GB live data</li>
                            <li>30 days of retention</li>
                            <li>Traditional: 420GB x 30 = 12.6TB needed</li>
                            <li>PBS deduplicated: ~1.9TB actually used</li>
                            <li>Savings: 85%</li>
                        </ul>
                        
                        <p><strong>Impact:</strong> Can afford longer retention on smaller drives, improving disaster recovery capabilities.</p>
                    </div>
                </div>
            </div>
            
            <div class="collapsible">
                <div class="collapsible-header">
                    <div class="collapsible-title">Lesson 3: Node-Level Redundancy Is Essential</div>
                    <div class="collapsible-icon">▼</div>
                </div>
                <div class="collapsible-content">
                    <div class="collapsible-inner">
                        <p><strong>Observation:</strong> Hardware fails. Single-instance backups are risky.</p>
                        
                        <p><strong>Scenario:</strong></p>
                        <ul>
                            <li>pve01's SATA drive fails (no warning)</li>
                            <li>Without sync: All backups lost</li>
                            <li>With sync: pve02 has complete copy, restore unaffected</li>
                        </ul>
                        
                        <p><strong>Investment:</strong> Minimal (second HDD + cron job)<br>
                        <strong>Protection:</strong> Maximum (complete backup redundancy)</p>
                    </div>
                </div>
            </div>
        </section>
        
        <!-- Interview Story -->
        <section class="section">
            <h2>Interview Story (STAR Format)</h2>
            
            <div class="star-format">
                <div class="star-item">
                    <div class="star-label">Situation</div>
                    <p>"I was running a 3-node Proxmox cluster with ~420GB of VM data, backing up to a 4.5TB external USB drive shared via NFS. The backup system was failing ~40% of nights due to USB disconnects and power management issues. VMs would sometimes shut down unexpectedly when the mount path disappeared mid-backup."</p>
                </div>
                
                <div class="star-item">
                    <div class="star-label">Task</div>
                    <p>"Redesign the backup infrastructure to achieve enterprise-grade reliability while working within hardware constraints (limited SATA ports, 1TB drives, existing cluster topology). The solution needed to maintain or improve retention periods despite smaller individual drive capacity."</p>
                </div>
                
                <div class="star-item">
                    <div class="star-label">Action</div>
                    <p>"I migrated to Proxmox Backup Server with a distributed architecture:</p>
                    <ul>
                        <li>Installed 1TB SATA drives in two nodes (eliminating USB dependency)</li>
                        <li>Partitioned one node's drive for dual-purpose: 200GB NFS share for ISOs/templates, 731GB for PBS sync target</li>
                        <li>Deployed PBS on both nodes with chunk-level deduplication</li>
                        <li>Configured automatic sync from primary to secondary (2-hour offset for redundancy)</li>
                        <li>Migrated existing backups using rsync with resume capability to handle interruptions</li>
                        <li>Implemented Let's Encrypt certificates via ACME for secure web UI access</li>
                        <li>Tuned ext4 filesystems (reduced reserved blocks from 5% to 1%, verified alignment)</li>
                    </ul>
                    <p>Technical challenges included handling USB disconnects during migration (solved with <code>rsync --partial</code>), configuring PBS ACME with Cloudflare DNS, and optimizing filesystem parameters for backup workloads."</p>
                </div>
                
                <div class="star-item">
                    <div class="star-label">Result</div>
                    <p>"Achieved 100% backup success rate (from 60%), reduced storage requirements by 85% through deduplication, and implemented node-level redundancy for hardware failure protection. Retention improved from 2-3 full rotations to 30 daily + 8 weekly + 12 monthly backups. Zero manual interventions required since deployment. The infrastructure now follows 3-2-1 backup principles and mirrors enterprise backup patterns used in production environments."</p>
                </div>
            </div>
        </section>
        
        <!-- Skills Demonstrated -->
        <section class="section">
            <h2>Skills Demonstrated</h2>
            
            <h3>Storage Engineering</h3>
            <div class="skills-grid">
                <span class="skill-badge">Filesystem Tuning</span>
                <span class="skill-badge">Partition Alignment</span>
                <span class="skill-badge">Deduplication</span>
                <span class="skill-badge">ext4</span>
                <span class="skill-badge">NFS</span>
            </div>
            
            <h3>Backup & Recovery</h3>
            <div class="skills-grid">
                <span class="skill-badge">3-2-1 Backup Principles</span>
                <span class="skill-badge">Retention Policies</span>
                <span class="skill-badge">Proxmox Backup Server</span>
                <span class="skill-badge">rsync</span>
                <span class="skill-badge">Data Migration</span>
            </div>
            
            <h3>Infrastructure Design</h3>
            <div class="skills-grid">
                <span class="skill-badge">Redundancy Design</span>
                <span class="skill-badge">Node-Level Replication</span>
                <span class="skill-badge">ACME/Let's Encrypt</span>
                <span class="skill-badge">Cloudflare DNS</span>
            </div>
            
            <h3>Linux Administration</h3>
            <div class="skills-grid">
                <span class="skill-badge">systemd</span>
                <span class="skill-badge">Power Management</span>
                <span class="skill-badge">Mount Lifecycle</span>
                <span class="skill-badge">tune2fs</span>
            </div>
        </section>
        
        <!-- What's Next -->
        <section class="section">
            <h2>What's Next</h2>
            
            <h3>Immediate Improvements</h3>
            <ul>
                <li><strong>Encryption:</strong> Enable PBS built-in encryption for backups at rest</li>
                <li><strong>Offsite Sync:</strong> Configure PBS sync to cloud storage (3-2-1 compliance)</li>
                <li><strong>Monitoring:</strong> Integrate PBS metrics into Grafana</li>
            </ul>
            
            <h3>Future Exploration</h3>
            <ul>
                <li><strong>Bare-Metal Recovery:</strong> Document full-cluster rebuild from PBS</li>
                <li><strong>Backup Verification:</strong> Automated restore testing</li>
                <li><strong>Storage Expansion:</strong> Plan for capacity growth as VM count increases</li>
            </ul>
        </section>
    </main>
    
    <footer role="contentinfo">
        <div class="footer-content">
            <nav class="footer-nav" aria-label="Footer navigation">
                <a href="/">Projects</a>
                <a href="/resume">Resume</a>
                <a href="/work-highlights">Work Examples</a>
            </nav>
            <p class="footer-copyright">Building enterprise-grade infrastructure, one project at a time.</p>
        </div>
    </footer>
    
    <script>
        // Collapsible sections with keyboard accessibility
        document.querySelectorAll('.collapsible-header').forEach(header => {
            header.addEventListener('click', () => {
                const collapsible = header.parentElement;
                collapsible.classList.toggle('active');
            });
            
            // Keyboard accessibility
            header.setAttribute('tabindex', '0');
            header.setAttribute('role', 'button');
            header.addEventListener('keydown', (e) => {
                if (e.key === 'Enter' || e.key === ' ') {
                    e.preventDefault();
                    header.click();
                }
            });
        });
    </script>
</body>
</html>